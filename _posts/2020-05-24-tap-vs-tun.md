---
layout: post
section-type: post
title: "OPEN VPN을 이용해서 vpn 환경 구축하기"
category: Network
tags: [ 'kosslab' ]
comments: true
---
제 블로그의 모든 글은 IMHO로 쓴 것입니다.
서로에 대한 존중을 담은 덧글을 남겨 소통을 하신다면 더 좋은 글로 발전이 될 수 있을 것 같습니다.
존중이 담기지 않은 덧글은 언제든 삭제될 수 있습니다.
감사합니다:)
---       


1.4. TUN/TAP 가상 디바이스 드라이버를 이용한 SSL VPN
SSL VPN은 브라우저를 이요한 웹서비스 접근, 즉 Proxy형태로 단일 포트 서비스를 중계하기 위한 목적으로 만들어 졌다. 이렇게 해서 얻을 수 있는 최대 장점은 클라이언트 측에서 별다른 프로그램의 설치 없이 웹 브라우저만 가지고 내부 정보에 접근할 수 있다는 점이다. 이는 특히 이동성이 중요해진 요즘에 중요한 장점이다.
컴퓨터 네트워크(:12)에서 TUN 과 TAP는 커널에서 제공하는 가상 네트워크 드라이버 다. 일반적인 네트워크 드라이버가 이더넷 카드등을 직접 제어하는 것과는 달리, 이들 가상 네트워크 드라이버는 소프트웨어적으로 구현된 가상의 네트워크 장치를 제어한다.
TAP은 OSI(:12)의 2 계층 (데이터 링크 계층)을 시뮬레이션 한다. TUN은 3 계층 (네트워크 계층)을 시뮬레이션한다.
가상 디바이스 드라이버를 사용한 VPN은 완전한 서브 네트워크 환경을 구성해 준다는 장점이 있다. 이는 모든 애플리케이션을 사용할 수 있음을 의미한다. 하지만 별도의 클라이언트 프로그램이 준비되어야 한다는 단점이 있다. 특히 루트 권한을 가지고 있어야 하는데, 운영체제에 따라서 이동성에 제약을 가져다 줄 수 있다.
TUN/TAP는 VPN 솔류션에서 사용한다. 가상 네트워크 드라이버를 만들고, 이 드라이버를 이용해서 가상 사설망을 구한다. 이 문서에서 다루는 OpenVPN이 TUN/TAP을 사용한다.
공개 소프트웨어로 OpenSSH도 TUN/TAP을 사용한다. 언제 시간이 되면 OpenSSH를 이용한 VPN 환경 구축도 소개하도록 하겠다.
OpenSSH와 OpenVPN은 TUN/TAP 디바이스를 이용해서 터널을 만들고, 그 터널을 SSL 암호화 한다.


open vpn은 오픈 소스 프로그램으로 가상 사설망을 구축할 수 있는 소프트웨어
OpenVPN은 SSL기반의 VPN으로 openssl라이브러리를 사용한다.


![vpn_before](/images/2020-05-24-openvpn/tun.png)


위의 그림은 OpenVPN 서버와 클라이언트에 tun 디바이스가 만들어지고,



# 기본원리

vpn은 물리적으로 떨어져 있는 두개의 네트워크를 가상의 네트워크로 묶는 개념
두개 이상의 네트워크를 하나의 네트워크로 보이려면 터널을 뚫으면 된다.

이 두 네트워크는 public ip가 있고, gateway가 갖춰지 그 사이에는 인터넷이 있다.
vpn이 다른 통신과 다른 것은 패킷을 한번 싸서 보낸다.



첫번째
1. easy-rsa 로 인증서만들기
- ca만들기
2. server 인증서 만들기
3. 클라이언트 인증서 만들기
4. openvpn구동
- 먼저 server구동
리슨 상태
tun0이라는 가상 어뎁
서버에 가보면 클라이언트에서 접속한 내용 볼 수 있다.
이제 클라에서 내부망 위치한 웹서버 접속




---  
참고자료: 
https://www.joinc.co.kr/w/Site/System_management/VPN
